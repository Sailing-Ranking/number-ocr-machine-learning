schema: '2.0'
stages:
  train:
    cmd: pipenv run python src/02_train.py
    params:
      params.yaml:
        compile.metrics: accuracy
        model.activation: relu
        model.filters: 32
        model.input_shape:
        - 28
        - 28
        - 1
        model.kernel_initializer: he_uniform
        model.kernel_size:
        - 3
        - 3
        model.out_activation: softmax
        model.pooling:
        - 2
        - 2
        train.epochs: 3
        train.validation_split: 0.25
    outs:
    - path: data/experiment/cnn_classifier
      md5: bd3506e92a873be1a25e66c7a281fa33.dir
      size: 1103956
      nfiles: 5
    - path: data/experiment/history.json
      md5: 2289e48163ce85408c8e9b0e57f8c6ce
      size: 218
  visualize:
    cmd: pipenv run python src/04_visualize.py
    deps:
    - path: data/experiment/history.json
      md5: 2289e48163ce85408c8e9b0e57f8c6ce
      size: 218
    - path: data/experiment/metrics.json
      md5: 20d29ac4e222a15943321ca1c6864a41
      size: 113
    - path: data/experiment/predictions.csv
      md5: 51d857b1fc974e00134373a7b85b216b
      size: 88905
    outs:
    - path: data/experiment/plots/acc_vs_val_acc.png
      md5: 416e216d77dc937f56e7e247b40731c3
      size: 36395
    - path: data/experiment/plots/loss_vs_val_loss.png
      md5: 152c0c34e036d00d05ffe4401c7f98ab
      size: 36840
  evaluate:
    cmd: pipenv run python src/03_evaluate.py
    deps:
    - path: data/experiment/cnn_classifier
      md5: bd3506e92a873be1a25e66c7a281fa33.dir
      size: 1103956
      nfiles: 5
    outs:
    - path: data/experiment/metrics.json
      md5: 20d29ac4e222a15943321ca1c6864a41
      size: 113
    - path: data/experiment/predictions.csv
      md5: 51d857b1fc974e00134373a7b85b216b
      size: 88905
  setup:
    cmd: pipenv run python src/01_setup.py
  test:
    cmd: pipenv run test src/05_test.py
    deps:
    - path: data/experiment/metrics.json
      md5: 20d29ac4e222a15943321ca1c6864a41
      size: 113
